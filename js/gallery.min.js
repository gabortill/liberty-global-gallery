function Gallery(){this.movingXPos=0;this.items=[];this.itemsLen=null;return this}Gallery.prototype.config=function(config){this.$={btnPrev:document.querySelector(config.prev),btnNext:document.querySelector(config.next),display:document.querySelector(config.display),moving:document.querySelector(config.moving)};this.unit=config.unit||200;this.visibleItemsLen=config.visibleItemsLen||3;return this};Gallery.prototype.getData=function(params){var request=new XMLHttpRequest;request.open("GET",params.url,true);request.setRequestHeader("Authorization",params.headerVal);request.onload=function(){if(request.status>=200&&request.status<400){var obj=JSON.parse(request.responseText);params.success(obj)}else{throw new Error("Reached server, but it returned an error!")}};request.onerror=function(evt){console.log("Error occured:",evt)};request.send()};Gallery.prototype.filterMapGenre=function(arr,type){var i=0;var len=arr.length;var filteredObj;for(;i<len;i++){filteredObj=arr[i].assets.filter(function(item){return item.genre===type}).map(function(item){return{imdb:item.imdb,img:item.img,title:item.title}});this.items=this.items.concat(filteredObj)}return this};Gallery.prototype.sortDescending=function(prop){this.items.sort(function(a,b){if(a[prop]>b[prop]){return-1}if(a[prop]<b[prop]){return 1}return 0});return this};Gallery.prototype.displayResults=function(){var self=this;var items=this.items;var len=items.length;var i=0;var markup="";self.$.display.style.width=self.unit*self.visibleItemsLen+"px";self.$.moving.style.width=self.unit*len+"px";for(;i<len;i++){markup+='<figure class="gallery__item">'+'<img height="270" src="'+items[i].img+'" width="186" />'+'<figcaption class="gallery__item__caption">'+items[i].title+" ("+items[i].imdb+")</figcaption>"+"</figure>"}self.$.moving.innerHTML=markup;return this};Gallery.prototype.cacheItemsLen=function(){this.itemsLen=this.items.length;return this};Gallery.prototype.movingTransition=function(pos){var self=this;self.$.moving.style.webkitTransform="translateX("+pos+"px)";self.$.moving.style.transform="translateX("+pos+"px)"};Gallery.prototype.moveToNext=function(fixThis){var self=fixThis;var turningPoint=-self.unit*(self.itemsLen-(self.visibleItemsLen+1));self.movingXPos=self.movingXPos>=turningPoint?self.movingXPos-self.unit:0;self.movingTransition(gallery.movingXPos);return this};Gallery.prototype.moveToPrev=function(fixThis){var self=fixThis;var turningPoint=-(self.itemsLen*self.unit-self.visibleItemsLen*self.unit);self.movingXPos=self.movingXPos>=0?turningPoint:self.movingXPos+self.unit;self.movingTransition(gallery.movingXPos)};Gallery.prototype.addEvents=function(){var self=this;self.$.btnNext.addEventListener("click",function(){self.moveToNext(self)});self.$.btnPrev.addEventListener("click",function(){self.moveToPrev(self)});document.addEventListener("keydown",function(evt){if(evt.keyCode===39){self.moveToNext(self)}if(evt.keyCode===37){self.moveToPrev(self)}});return this};var gallery=new Gallery;gallery.config({display:".gallery__display",moving:".gallery__display__moving",next:".gallery__btn--next",prev:".gallery__btn--prev"});gallery.getData({url:"//lg-devtest.herokuapp.com/data.json",headerVal:"Bearer u12A8f3Zg",success:function(obj){var arr=obj.data;gallery.filterMapGenre(arr,"Action").sortDescending("imdb").cacheItemsLen().displayResults().addEvents()}});